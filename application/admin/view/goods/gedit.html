<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit">
	<title> hAdmin- 主页</title>
    <script type="text/javascript" src="__STATIC__/jquery-3.2.1.min (1).js"></script>
    <script src="__STATIC__/js/chosen.jquery.js" type="text/javascript"></script>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->

    <link rel="shortcut icon" href="favicon.ico"> <link href="__STATIC__/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link rel="stylesheet" href="__STATIC__/css/chosen1.css">
    <link href="__STATIC__/css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
    <link href="__STATIC__/css/animate.css" rel="stylesheet">
    <link href="__STATIC__/css/style.css?v=4.1.0" rel="stylesheet">
    <style type="text/css">
/*    .chosen-select{
        display: none;
    }
    .chzn-container{
        display: none;
    }*/
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button{
        -webkit-appearance: none !important;
        margin: 0; 
    }
    input[type="number"]{-moz-appearance:textfield;} 
    .inp{
        float: left;
        height: 38px;
        padding-left: 12px;
        margin-left: 40px;
        width: 220px; 
        font-size: 18px; 
        }
    .text{
        margin-top: 50px;
        margin-left: 210px;
        height: 50px;
        width: 200px;
        margin-bottom: 60px;
        background-color: #3EBD00;
        color: white;
        border: none;
        font-size: 20px;
        text-align: center;
    }
    .add{
        display: none;
        height: 96px;
        width: 183px;
        background-color: white;
        position: absolute;
        top: 313px;
        left: 488px;
        border: 1px solid #bdb8b8;
        border-radius: 5px;
    }
    .bq{
        margin-left: 20px;
        float: left;
        margin-top: 40px;
        color: #0074e0;
    }
    .arrow{
        display: none;
        width: 0;
        height: 0;
        border: 10px solid transparent;
        border-bottom: 10px solid rgb(0,0,0);
        position: absolute;
        top: 291px;
        left: 563px;
    }
    .mbz{
        position: absolute;left: 165px;top: 341px;font-size: 25px;
    }
    .fabu{
        margin-top: 14px;margin-left: 40px;font-size: 24px;color: #e84343;margin-bottom: 30px;
    }
    .title{
        margin-left: 40px;font-size: 20px;color: black;float: left;margin-top:2px;
    }
    .gimg{
        margin-left: 40px;font-size: 20px;color: black;float: left;margin-top:55px;
    }
    .picture{
        height: 100px;width: 100px;background-color: white;margin-left:40px;margin-top:22px;float: left;border: 1px solid;text-align: center;font-size: 40px
    }
    .tname{
        margin-left: 40px;font-size: 20px;color: black;float: left;margin-top:40px;
    }
    .img-item{
        width: 100%;
        height: 100%;        
    }
    </style>
    </head>
<body>
<!-- <span class="mbz">￥</span>
<span class="mbz" style="top: 413px;">￥</span> -->
<div class="fabu">编辑商品</div>
<form action="updateOneGood" method="POST" enctype="multipart/form-data" >
<div>
    <div class="title">商品标题</div>
    <input type="num" name="title" placeholder="请输入商品标题" value="{$data.name}" class="inp" style="width: 300px;" required>
</div>
<div style="clear: both;"></div>
<div class="gimg">商品图片</div>

<!-- <div style="height: 100px;width: 100px;margin-left:40px;margin-top:22px;float: left;background-color: red;"></div> -->
<div class="picture" >
    <img src="__STATIC__/goodimage/{$data.img}" style="width: 100%;height: 100%;">
</div>


<div style="margin-top: 42px;font-size: 20px;color: #d0caca; margin-left: 10px;float: left;width: 200px;">640×640像素2335×600像素</div>

<input type="file" name="file" class="file" style="display: none;" >
<input type="hidden" name="gid" value="{$gid}">
<input type="hidden" name="imagegg" value="{$data.img}">

<div style="clear: both;"></div>
<div class="tname">商品标签</div>
<select data-placeholder="选择标签" multiple class="chosen-select" style="width:350px;" tabindex="18" id="multiple-label-example" name="goodstip[]" required>
    {foreach tipss as $list1}
        <option class="ttip" value="{$list1.id}" selected = "selected">{$list1.name}</option>    
    {/foreach}
    {foreach tippp as $list2}
        <option class="ttip" value="{$list2.id}" >{$list2.name}</option>    
    {/foreach}
</select>
<!-- <div class="bq">+添加标签</div> -->
<div style="clear: both;"></div>

<div class="tname">价格&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
<input type="number" required="required" step="0.01" name="nowprice" value="{$data.money}"   class="inp" style="margin-top: 33px;padding-left: 8px;">
<div style="clear: both;"></div>

<div class="tname">原价&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<input type="number" name="yuanprice" step="0.01" value="{$data.newmoney}" min="0"  class="inp" style="margin-top: 33px;padding-left: 8px;">
<div style="margin-top: 27px;font-size: 16px;color: #bbb6b6;margin-left: 10px;float: left;width: 100px;">为0时，只显示价格</div>
<div style="clear: both;"></div>

<div class="tname">库存&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
{if condition="$data.number eq -1"}
<input type="num" name="number" value=""  onkeyup="this.value=this.value.replace(/\D/g, '')" class="inp" style="margin-top: 33px;">
{else/}
<input type="num" name="number" value="{$data.number}"  onkeyup="this.value=this.value.replace(/\D/g, '')" class="inp" style="margin-top: 33px;">
{/if}
<div style="clear: both;"></di>

<div class="tname">运费&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
<select class="form-control m-b" name="account" style="width: 220px;margin-top: 37px;float: left;margin-left: 40px;height: 38px;">
{if condition="$data.sendmoney eq 5.00"}
    <option value="5" selected = "selected">5元</option>
    <option value="0">免运费</option>
{else/}
    <option value="5" >5元</option>
    <option value="0" selected = "selected">免运费</option>
{/if}
    
</select>
<div style="clear: both;"></div>

<div class="tname">每人限购</div>
<input type="num" name="limitnum" value="{$data.type}" onkeyup="this.value=this.value.replace(/\D/g, '')" class="inp" style="margin-top: 33px;">
<input type="text" name="typee" class="no" value="11" style="margin-top: 33px; display: none;" >
<div style="margin-top: 33px;float: left;margin-left: 10px;font-size: 22px;color: #d2caca;">0代表不限购</div>
<div style="clear: both;"></div>

<div class="arrow"></div>

<div class="add">
    <input style="margin-top: 11px;margin-left: 11px;height: 33px;width: 160px;padding-left: 5px;" type="text" name="sname" maxlength="6" placeholder="请输入标签名称">
    <input style="    margin-top: 14px;margin-left: 11px;height: 30px;width: 48px;text-align: center;background-color: #3EBD00;color: white;border: none;float: left;border-radius: 5px;" type="button" name="sadd" value="添加">
    <input style="width: 48px;height: 30px;margin-top: 14px;margin-left: 15px;border: 1px solid;color: black;border-radius: 5px;text-align: center;" class="cancel" type="button" name="text" value="取消">
</div>





<input type="submit" name="text" class="text" value="保存">
</form>
<script type="text/javascript">
    
    var config = {
      '.chosen-select'           : {},
      '.chosen-select-deselect'  : {allow_single_deselect:true},
      '.chosen-select-no-single' : {disable_search_threshold:10},
      '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
      '.chosen-select-width'     : {width:"95%"}
    }
    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }
    function localView(from) {
        var file = from.files[0]
        var url = null ;

        if (window.createObjectURL!=undefined) { 
            url = window.createObjectURL(file) ;
        } else if (window.URL!=undefined) {
            url = window.URL.createObjectURL(file) ;
        } else if (window.webkitURL!=undefined) { 
            url = window.webkitURL.createObjectURL(file) ;
        }
        return url
         // var t = $(this).find(".img-item").attr(src)
       
    }
$(function(){
    

    // 如果要初始化已选中的项，需要在调用chosen()函数之前调用chose_mult_set_ini()函数
    // 设置<select>的<option>属性selected='selected'，这样chosen()函数被调用时，相应项会显示在框中
    var imgLoad = function (url, callback) {
        var img = new Image();
        img.src = url;
        if (img.complete){
            callback(img.width, img.height);
        } else {
            img.onload = function () {
                callback(img.width, img.height);
                img.onload = null;
            };
        }
    }
    $(".picture").click(function(){

       $(".file").click()


    })
    $(document).on("change",".file",function(){
        
        var url = localView(this)
         imgLoad(url,function(w,h){
            // console.log(w,h)
            if(!(w==640 && h==640 ||w==2335 && h==600)){
                alert("选择上传的图片不符合要求，请重新上传图片！")
                $(".picture").html('<span style="margin-top: 20px;display: inline-block;">+</span>')  
                
            }else{
                 if(w==640 && h==640){
                    var t = 0
                    $(".no").val(t)
                   
                }else{
                    var t = 1
                    $(".no").val(t)
                }
               $(".picture").html('<img src="'+url+'" class="img-item">')  
            }
        })
       
        // $(".picture").html('<img src="'+url+'" class="img-item">')
    })
    $(".bq").click(function(){
        $(".add").toggle()
        $(".arrow").toggle()

    })

    $(".cancel").click(function(){
        $(".add").toggle()
        $(".arrow").toggle()
    })
    $("input[name=sadd]").click(function(){
    console.log(123456)
    onetip = $("input[name=sname]").val()
    if(onetip != ""){
        // ajax 执行完在append
        $.post("{:url('admin/label/addOne')}",{name:onetip},function(data){
            console.log(data);
            $(".add").toggle()
            $(".arrow").toggle()
            $("input[name=sname]").val("")
            $(".chosen-select").append('<option value="'+data[0]+'">'+data[1]+'</option>')
            linum = $(".chzn-results").find("li").length
            console.log(linum)
            $(".chzn-results").append('<li id="multiple-label-example_chzn_o_'+linum+'" class="active-result">'+data[1]+'</li>')
            window.location.reload();
        }) 
        
    }
})
})


</script>

<script src="__STATIC__/js/jquery.min.js?v=2.1.4"></script>
<script src="__STATIC__/js/bootstrap.min.js?v=3.3.6"></script>
<script src="__STATIC__/js/plugins/metisMenu/jquery.metisMenu.js"></script>
<script src="__STATIC__/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
<script src="__STATIC__/js/plugins/layer/layer.min.js"></script>


<!-- 自定义js -->
<script src="__STATIC__/js/hAdmin.js?v=4.1.0"></script>
<script type="text/javascript" src="__STATIC__/js/index.js"></script>

</body>
</html>